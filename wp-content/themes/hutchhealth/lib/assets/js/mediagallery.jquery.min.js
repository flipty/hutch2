(function($){$.fn.mediaUploader = function(options){var defaults ={title:'Choose Image:',button_text:'Choose Image',urlField:'#upload_image',allowMultiple:false,viewOutput:false,viewOutputWidth:150,viewOutputHeight:150,viewOutputDIV:'#multiple_selection',viewOutputHiddenField:'image[]',library:{type:'image'},allowCustomOutput:false,customOutput:function(){}};var option = $.extend(defaults,options);return this.each(function(){var mediauploader;$(this).click(function(e){e.preventDefault();if(mediauploader){mediauploader.open();return}mediauploader = wp.media.frames.file_frame = wp.media({title:option.title,library:option.library,button:{text:option.button_text,close:true},multiple:option.allowMultiple});mediauploader.on('select',function(){selection = mediauploader.state().get('selection');selection.map(function(attachment){attachment = attachment.toJSON();var attachmentURL = attachment.url;var attachmentID = attachment.id;$(option.urlField).val(attachmentURL);if(option.viewOutput == true){if(option.allowCustomOutput == true){option.customOutput(attachment,option);return}var width = option.viewOutputWidth;var height = option.viewOutputHeight;var hiddenField = option.viewOutputHiddenField;if(attachment.type == "image"){var append = '<div style="float:left;padding:0 5px;" id="'+attachmentID+'">'+'<img src="'+attachmentURL+'" style=" height:'+height+'px;width:'+width+'px;" />'+'<input type="hidden" name="'+hiddenField+'" value="'+attachmentURL+'" /><br />'+'<a href="#" id="remove">Remove</a>'+'</div>'}else{var append = '<div style="clear:both;padding:5px 0 0;" id="'+attachmentID+'">'+'<strong>File Type:</strong>'+attachment.type+'<br />'+'<strong>File URL:</strong>'+attachmentURL+'<br />'+'<input type="hidden" name="'+hiddenField+'" value="'+attachmentURL+'" />'+'<a href="#" id="remove">Remove</a>'+'</div>'}$(option.viewOutputDIV).append(append);$('a#remove').click(function(e){e.preventDefault();$(this).parent().remove()})}})});mediauploader.open()})})}}(jQuery));
